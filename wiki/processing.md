<link href="../styles.css" rel="stylesheet" />

## Обработка данных для машинного обучения

- [Обработка данных для машинного обучения](#обработка-данных-для-машинного-обучения)
  - [Цели и задачи](#цели-и-задачи)
  - [Введение в обработку данных](#введение-в-обработку-данных)
  - [Предобработка данных](#предобработка-данных)
    - [Выбор признаков для обучения](#выбор-признаков-для-обучения)
  - [Работа с категориальными и числовыми признаками](#работа-с-категориальными-и-числовыми-признаками)
    - [Категориальные признаки](#категориальные-признаки)
    - [Числовые признаки](#числовые-признаки)
  - [Заключение](#заключение)
  - [Задание на взаимную проверку](#задание-на-взаимную-проверку)
  - [Источники информации](#источники-информации)

### Цели и задачи
**Цель урока**: познакомиться с методами обработки данных для машинного обучения и понять, для чего каждый их них используется.

В уроке мы изучим, как подготовить данные для обучения, как обрабатывать пропущенные значения, выбросы и категориальные признаки, а также как проводить масштабирование и нормализацию данных.[^data]

### Введение в обработку данных
Обработка данных является важным шагом в процессе машинного обучения. Неверно обработанные данные могут привести к плохим результатам и осложнить задачу обучения. В этом разделе рассматриваются основные методы обработки данных, которые помогут улучшить качество модели машинного обучения и сделать ее более точной и эффективной.

### Предобработка данных
Предобработка данных является важным этапом в процессе машинного обучения, который включает в себя подготовку данных для анализа и обучения модели. В этом разделе мы рассмотрим основные шаги предобработки данных **для машинного обучения**:

- **Импортирование данных**. Первый шаг – это импортирование данных из источника. Источником данных могут быть файлы CSV, TSV или Excel, база данных, Интернет, отчеты, логи, документы и т.д.
- **Оценка данных**. После импорта данных необходимо оценить данные. Этот шаг включает в себя проверку наличия пропущенных значений, выбросов и некорректных значений. Важно также оценить распределение данных и определить, какие признаки влияют на целевую переменную.
- **Удаление дубликатов**. Дубликаты данных могут привести к искажению результатов их анализа. Поэтому перед анализом данных необходимо удалить дубликаты.
- **Обработка пропущенных значений**. Пропущенные значения могут влиять на результаты анализа данных и обучение модели. Необходимо определить, какие данные отсутствуют, и заполнить пропущенные значения. Это можно сделать путем замены пропущенных значений на среднее значение, медиану или моду в зависимости от типа данных.
- **Обработка выбросов**. Выбросы также могут искажать результаты анализа данных и обучение модели. Поэтому нужно определить выбросы и удалить или исправить их. Это можно сделать посредством установления пороговых значений для каждого признака и удаления значений, выходящих за пределы порогов.
- **Обработка категориальных признаков**. Категориальные признаки могут быть представлены в виде строковых значений. Эти значения нужно преобразовать в числовые значения для использования в алгоритмах машинного обучения. Это делается путем кодирования категориальных признаков, например, с помощью методов One-Hot Encoding, Label Encoding и т.д.
- **Масштабирование и нормализация данных**. Масштабирование и нормализация данных позволяют улучшить результаты анализа данных и обучение модели. <dfn title="масштабирование данных">Масштабирование</dfn> (*scaling*) относится к изменению диапазона значений признака, а <dfn title="нормализация данных">нормализация</dfn> (*normalization*) – к приведению значений признака к стандартному нормальному распределению. Масштабирование и нормализация данных также способны ускорить обучение модели и улучшить ее стабильность.
- **Кодирование данных**. <dfn title="кодирование данных">Кодирование данных</dfn> (*data encoding*) – это процесс преобразования категориальных признаков в числовые значения, которые могут быть использованы в алгоритмах машинного обучения. Здесь снова можно задействовать методы One-Hot Encoding, Label Encoding и т.д.
- **Разделение данных на обучающую и тестовую выборки**. Перед обучением модели необходимо разделить данные на обучающую и тестовую выборки. Обучающая выборка, как вы помните, используется для обучения модели, а тестовая выборка – для проверки ее точности. Разделение данных на обучающую и тестовую выборки помогает избежать переобучения модели.
- **Финальная обработка данных**. После выполнения всех предыдущих шагов следует произвести финальную обработку данных. Этот шаг может включать в себя удаление ненужных признаков, создание новых признаков на основе существующих, выполнение дополнительной фильтрации данных и т.д.

Качественная предобработка данных помогает улучшить точность модели машинного обучения и избежать искажений результатов анализа данных. Она также может ускорить процесс обучения модели, поскольку хорошо предобработанные данные могут быть быстро обработаны и использованы для обучения модели. Исходя из этого, этапу предобработки необходимо уделить достаточно времени и внимания.

Предобработка данных – это лишь первый этап, после которого производится выбор признаков для обучения. Он может быть основан на экспертном знании в области решаемой задачи, на статистических методах, таких как корреляционный анализ, метод главных компонент или отбор признаков на основе моделей машинного обучения. И далее мы рассмотрим именно этот этап.

#### Выбор признаков для обучения
> <dfn title="признак">Признаки</dfn> (*features*) – это характеристики объектов, которые используются для описания их свойств и позволяют различать объекты друг от друга. В контексте машинного обучения признаки используются для обучения моделей и предсказания значений целевой переменной на основе имеющихся данных.

Признаки могут быть числовыми, бинарными или категориальными в зависимости от типа данных, которые они представляют. Например, числовые признаки представляются числами, бинарные признаки принимают только два значения (например, 0 или 1), а категориальные признаки представляются строками или метками и могут иметь несколько значений.

Признаки являются ключевым элементом в построении моделей машинного обучения. Правильно выбранные признаки позволяют улучшить точность модели и повысить ее стабильность. Кроме того, правильно выбранные признаки помогают обойти проблему проклятия размерности, которая возникает при работе с данными в высокоразмерном пространстве признаков. (Она связана с тем, что при увеличении размерности пространства признаков количество данных, необходимых для описания пространства, растет экспоненциально. Это означает, что при увеличении количества признаков необходимо иметь значительно больше данных для обучения модели.)
 
Важно также учитывать, что выбор признаков зависит от контекста задачи и требует тщательного анализа данных и экспертного знания в области решаемой задачи. Некорректно выбранные или недостаточные признаки могут привести к низкой точности модели и ошибочным результатам. На этапе выбора признаков необходимо учитывать различные аспекты, такие как качество данных, размер признакового пространства, уникальность признаков и т.д.

Среди основных методов, которые могут быть использованы для выбора признаков для обучения модели, **выделяют**:

1. **Корреляционный анализ**. Корреляционный анализ используется для определения степени взаимосвязи между признаками и целевой переменной. Признаки с высокой корреляцией с целевой переменной могут быть выбраны для использования в модели, поскольку они помогают предсказывать целевую переменную с высокой точностью. Однако не следует использовать признаки с высокой корреляцией между собой, т.к. они способны привести к мультиколлинеарности (наличию линейной зависимости между объясняющими переменными), что усложнит интерпретацию результатов модели.

2. **Метод главных компонент**. Метод главных компонент используется для уменьшения размерности признакового пространства путем проекции исходных признаков на новые оси, которые максимально сохраняют информацию о данных. Таким образом, можно выбрать наиболее важные признаки и избежать проблем с мультиколлинеарностью. Однако метод главных компонент может быть менее интерпретируемым, чем другие методы выбора признаков.

3. **Отбор признаков на основе моделей машинного обучения**. Отбор признаков на основе моделей машинного обучения позволяет выбрать наиболее значимые признаки на основе их важности для конкретной модели машинного обучения. Например, можно использовать метод перебора всех комбинаций признаков и выбрать те признаки, которые дают наилучшую точность модели. Однако этот метод может быть вычислительно затратным и требовать большого количества вычислительных ресурсов.

Важно также учитывать контекст применения модели машинного обучения и цель исследования при выборе признаков. Например, для задачи бинарной классификации можно выбрать только те признаки, которые сильно коррелируют с целевой переменной и имеют низкую корреляцию друг с другом. Плюс необходимо учитывать качество данных, т.к. некорректные или неполные данные могут привести к выбору ошибочных признаков.

Следует иметь в виду, что выбор признаков может быть итеративным процессом. Если после обучения модели выясняется, что выбранные признаки не дали хорошей точности модели, можно вернуться к этапу выбора признаков и выбрать другие.

И уже по окончании этапа признаков необходимо провести работу с категориальными и числовыми признаками, которая тоже состоит из ряда элементов.

### Работа с категориальными и числовыми признаками
Работа с категориальными и числовыми признаками – еще один важный этап в предобработке данных для моделирования и машинного обучения. Она включает в себя различные методы преобразования признаков, которые позволяют обработать их таким образом, чтобы они были пригодны для использования в моделях машинного обучения.

#### Категориальные признаки
<dfn title="категориальные признаки">Категориальные признаки</dfn> – это признаки, которые описываются метками или строковыми значениями, такими как цвет, тип или категория объекта. Категориальные признаки могут быть преобразованы в числовые признаки, которые можно применять в моделях машинного обучения. Существует несколько методов преобразования категориальных признаков:

- <dfn title="label encoding">Label Encoding</dfn> – метод преобразования категориальных признаков в числовые значения. Каждое значение категориального признака заменяется на соответствующее ему число. Этот метод подходит для признаков с порядком значений, таких, например, как уровень образования.

- <dfn title="one-hot encoding">One-Hot Encoding</dfn> – метод преобразования категориальных признаков в бинарные значения. Каждое значение категориального признака заменяется на столбец бинарных значений, где 1 указывает на присутствие значения признака, а 0 – на его отсутствие. Этот метод подходит для признаков без порядка значений, таких как цвет или тип объекта.

- <dfn title="binary encoding">Binary Encoding</dfn> – метод преобразования категориальных признаков в бинарные значения с использованием кодирования Грея. Каждое значение категориального признака заменяется на бинарное значение, где каждый следующий столбец имеет значение, отличное от предыдущего на одну позицию. Этот метод также подходит для признаков без порядка значений.

Категориальный признак может быть связан с числовым признаком, таким как стоимость товара или количество проданных единиц. В таком случае категориальный признак может быть преобразован в числовой признак, чтобы стать частью общего набора признаков для модели машинного обучения.

Кроме того, категориальные признаки могут быть использованы для создания новых числовых признаков. Например, если в задаче машинного обучения используется признак «Тип продукта», его можно разбить на несколько категорий и создать для каждой категории отдельный числовой признак, который будет содержать среднее значение цены товара в этой категории.

#### Числовые признаки
<dfn title="числовые признаки">Числовые признаки</dfn> – это признаки, которые описываются числовыми значениями (к примеру, возраст, вес или высота объекта). Числовые признаки могут быть обработаны следующими методами:

1. <dfn title="масштабирование">Масштабирование</dfn> – метод преобразования числовых признаков, который позволяет установить диапазон значений для признака. Например, можно масштабировать признаки таким образом, чтобы они находились в диапазоне от 0 до 1 или от -1 до 1. Это помогает улучшить стабильность модели и облегчает сравнение признаков с различными масштабами.

2. <dfn title="нормализация">Нормализация</dfn> – метод преобразования числовых признаков, который позволяет установить нулевое среднее значение и единичное стандартное отклонение. Благодаря этому можно уменьшить влияние выбросов и улучшить стабильность модели.

3. <dfn title="дискретизация">Дискретизация</dfn> – метод преобразования числовых признаков в категориальные значения. Например, можно разбить возраст на несколько диапазонов и присвоить каждому диапазону соответствующую категорию. Это может быть полезно, когда числовой признак имеет большое количество уникальных значений.

4. <dfn title="стандартизация">Стандартизация</dfn> – метод преобразования числовых признаков, который позволяет привести значения признаков к стандартному виду с нулевым средним значением и единичным стандартным отклонением. Это делает данные более сравнимыми и помогает улучшить работу модели машинного обучения, особенно в случаях, когда распределение значений признаков сильно отличается от нормального распределения.

Важно учитывать, что выбор метода преобразования признаков зависит от конкретной задачи машинного обучения и требует тщательного анализа данных и экспертного знания в области решаемой задачи. Цель состоит в том, чтобы получить набор признаков, который максимально точно описывает объекты и помогает достичь лучшей производительности модели.

### Заключение
Таким образом, мы в общих чертах познакомились с процессом и особенностями обработки данных для машинного обучения. Это очень важный этап в работе искусственного интеллекта, который имеет решающее значение для достижения высокой производительности моделей машинного обучения.

> От него зависит качество данных, ключевой фактор для достижения высокой производительности моделей машинного обучения. Он позволяет извлечь новые признаки и улучшить модель, выявить скрытые зависимости и сделать более точные прогнозы, способен улучшить интерпретируемость модели и сократить время обучения.

Обработка данных для машинного обучения – это настоящее искусство, требующее опыта, экспертного знания и тщательного анализа данных. Кроме того, не существует универсального подхода к обработке данных, который бы подходил для всех задач машинного обучения. Результаты обработки данных зависят от конкретной задачи, а грамотно обработанные данные – это итог работы команды профессионалов.

Помимо прочего, обработка данных является неотъемлемой частью глубокого обучения и нейронных сетей, где данные играют решающую роль в обучении модели и достижении высокой производительности. И в следующем уроке мы поговорим как раз на эту тему. А сейчас предлагаем закрепить материал урока с помощью проверочного теста.[^data]

### Задание на взаимную проверку
Чтобы вы могли лучше понять, как обрабатывать данные для использования в моделях машинного обучения, а также улучшить свое понимание сложных технических процессов, предлагаем выполнить интересное задание.

Выберите набор данных для машинного обучения из открытых источников (UCI Machine Learning Repository, Kaggle, Google Dataset Search, OpenML и т.д.), например, набор данных MNIST для распознавания рукописных цифр.

Опишите, какие этапы, на ваш взгляд, нужно пройти для подготовки данных к использованию в модели машинного обучения (к примеру, очистка и обработка данных, разбиение данных на обучающую и тестовую выборки и т.д.)

Это задание на взаимную проверку, поэтому сначала вам нужно проверить две работы других пользователей, а затем загрузить свою. При проверке чужих работ вам необходимо оценить, как другие учащиеся поняли тему, насколько понятны и ясны предложенные описания. При желании можете дать комментарий и предложить свои изменения.[^data]

### Источники информации
[^data]: [Урок 3. Обработка данных для машинного обучения](https://4brain.ru/aibasics/data.php)
