## Практическая работа 3. Дисперсионный анализ статистических данных

### Содержание
- [Практическая работа 3. Дисперсионный анализ статистических данных](#практическая-работа-3-дисперсионный-анализ-статистических-данных)
  - [Содержание](#содержание)
  - [Цель работы](#цель-работы)
  - [Исходные данные](#исходные-данные)
  - [Задание](#задание)
  - [Решение](#решение)
    - [1. Построение вариационных рядов](#1-построение-вариационных-рядов)
    - [2. Построение гистограммы распределений](#2-построение-гистограммы-распределений)
    - [3. Определение основных числовых характеристик](#3-определение-основных-числовых-характеристик)
    - [4. Определение обобщенных числовых характеристик](#4-определение-обобщенных-числовых-характеристик)
      - [Оценка центральной тенденции](#оценка-центральной-тенденции)
      - [Оценка разрабоса данных](#оценка-разрабоса-данных)
      - [Оценка степени вариативности](#оценка-степени-вариативности)
  - [Заключение](#заключение)

### Цель работы
Данная работа направлена на изучение характеристик значений признака с целью установления некоторых общих тенденций и закономерностей распределения данных с использованием количественных и графических методов. Установленные в ходе работы количественные показатели должны помочь понять, как распределены данные, насколько они стабильны и разнообразны. Основная цель работы — научиться выполнять базовый статистический анализ значений признака для оценки центральной тенденции, разброса, вариативности, формы, нормальности, симметричности и однородности выборки, что позволит сделать выводы относительно характера и особенностей исследуемого распределения.

### Исходные данные
В качестве данных используется случайная неупорядоченная выборка из 30 значений роста студентов (в сантиметрах), полученная в результате измерения данного признака ($X$) в группе. Таблица 1 демонстрирует набор исходных данных (вариант 0а).

*Таблица 1. Набор исходных данных (выборочная совокупность)*

<table>
<tr>
<td>173</td><td>169</td><td>180</td><td>175</td><td>177</td><td>164</td><td>179</td><td>163</td><td>170</td><td>180</td>
</tr>
<tr>
<td>182</td><td>165</td><td>176</td><td>166</td><td>172</td><td>171</td><td>167</td><td>168</td><td>174</td><td>178</td>
</tr>
<tr>
<td>169</td><td>175</td><td>179</td><td>177</td><td>164</td><td>168</td><td>177</td><td>171</td><td>163</td><td>160</td>
</tr>
</table>

### Задание
1. Составить дискретный и интервальный вариационные ряды для выборки данных по признаку $X$ в соответствии с индивидуальным вариантом.
2. Построить гистограмму распределения значений признака $X$.
3. Определить основные числовые характеристики признака $X$:
     - объем выборки $n$;
     - минимальное и максимальное значения $x_{\min}$ и $x_{\max}$;
     - размах вариации $R(X)$;
     - моду $m_o$;
     - медиану $m_e$;
     - выборочное среднее $\bar{x}$;
     - выборочную дисперсию $S^2$;
     - выборочное стандартное отклонение $S$;
     - относительное стандартное отклонение $c_v$.
4. Проанализировать обобщенные характеристики (центральную тенденцию, разброс данных, степень вариативности) и сделать выводы относительно выборки (форме, нормальности, симметричности и однородности).

### Решение

#### 1. Построение вариационных рядов
Для построения дискретного вариационного ряда необходимо сначала отсортировать значения выборки по возрастанию или убыванию. Таблица 2 демонстрирует выборку, отсортированную по возрастанию.

*Таблица 2. Отсортированная выборка*

<table>
<tr>
<td>160</td><td>163</td><td>163</td><td>164</td><td>164</td><td>165</td><td>166</td><td>167</td><td>168</td><td>168</td>
</tr>
<tr>
<td>169</td><td>169</td><td>170</td><td>171</td><td>171</td><td>172</td><td>173</td><td>174</td><td>175</td><td>175</td>
</tr>
<tr>
<td>176</td><td>177</td><td>177</td><td>177</td><td>178</td><td>179</td><td>179</td><td>180</td><td>180</td><td>182</td>
</tr>
</table>

Дискретный вариационный ряд формируется из упорядоченных значений вариант (уникальных значений) и соответствующих им абсолютных частот (числа повторений признака с данным значением). Таблица 3 демонстрирует дискретный вариационный ряд.

*Таблица 3. Дискретный вариационный ряд*

$x_i$ | 160 | 163 | 164 | 165 | 166 | 167 | 168 | 169 | 170 | 171
-- | -- | -- | -- | -- | -- | -- | -- | -- | -- | --
$n_i$ | 1 | 2 | 2 | 1 | 1 | 1 | 2 | 2 | 1 | 2

$x_i$ | 172 | 173 | 174 | 175 | 176 | 177 | 178 | 179 | 180 | 182
-- | -- | -- | -- | -- | -- | -- | -- | -- | -- | --
$n_i$ | 1 | 1 | 1 | 2 | 1 | 3 | 1 | 2 | 2 | 1

Дискретный вариационный ряд позволяет определить некоторые характеристики выборочного распределения:

1. $n = 30$ — объем выборки, количество элементов совокупности или сумма абсолютных частот вариант.
2. $x_{\min} = 160$ — наименьшее значение, крайнее левое в таблице.
3. $x_{\max} = 182$ — наибольшее значение, крайнее правое в таблице.
4. $R(x) = x_{\max} - x_{\min} = 182 - 160 = 22$ — размах вариации, разница между крайними значениями.

В интервальном ряду значения признаков задаются в виде интервалов. Для его построения необходимо определить оптимальное число интервалов.

Согласно формуле Стерджеса рекомендуемое число интервалов:

$$ k = 1 + 3.322 \cdot \lg{n} = 1 + 3.322 \cdot \lg{30} \approx 5.91 \tag{1} $$

Число интервалов не может быть нецелым, поэтому округляют до ближайшего целого — либо меньшего, либо большего. Стратегия округления определяется индивидуально в зависимости от характера данных. В данном случае можно попробовать округлить в большую сторону, приняв $k = 6$.

Длина интервала вычисляется следующим образом:

$$ h = \frac{x_{\max} - x_{\min}}{k} = \frac{R(x)}{k} = \frac{22}{6} \approx 3.72 \tag{2} $$

Длина интервала в принципе может быть нецелой, но в данном случае удобно округлить до целого в большую сторону и принять $h = 4$.

За начало первого интервала рекомендуется брать следующую величину:

$$ x_{нач} = x_{\min} - \frac{h}{2} = 160 - \frac{4}{2} = 158 \tag{3} $$

Это позволяет сформировать 6 непересекающихся смежных интервалов длиной 4:

1. 158–162
2. 162–166
3. 166–170
4. 170–174
5. 174–178
6. 178–182

Получив эти значения, необходимо проверить, укладываются ли экстремальные значения выборки в крайние границы интервалов. В данном случае минимальные и максимальные значения находятся либо внутри ($x_{\min}$), либо на крайней границе ($x_{\max}$).

Для построения интервального вариационного ряда значения вариант группируются в интервалы длиной $h$ числом $k$. Для каждого интервала (вариации) суммируются значения соответствующих абсолютных частот $n_i$, а также вычисляются значения относительных частот (частостей) $w_i = n_i/n$. Для удобства все вариации в интервальном вариационном ряду обозначаются порядковыми числительными (начиная с 1), а также добавляются контрольные суммы. Таблица 4 демонстрирует интервальный вариационный ряд.

*Таблица 4. Интервальный вариационный ряд*

| Вариация | *1* | *2* | *3* | *4* | *5* | *6* | $\sum$
-- | -- | -- | -- | -- | -- | -- | --
$x_i; x_i+h$ | $[158; 162]$ | $(162; 166]$ | $(166; 170]$ | $(170; 174]$ | $(174; 178]$ | $(178; 182]$ | $[158; 182]$
$n_i$ | 1 | 6 | 6 | 5 | 7 | 5 | **30**
$w_i = \frac{n_i}{n}$ | 0.033 | 0.200 | 0.200 | 0.167 | 0.233 | 0.167 | **1**

<br>

#### 2. Построение гистограммы распределений
Источником данных для построения гистограммы является интервальный вариационный ряд, приведенный в таблице 4. Столбцы гистограммы выражают относительные частоты вариаций (частости), позволяя графически изобразить форму распределения, что дает возможность судить о его характере.

Для удобства построения гистограммы интервальный вариационный ряд расширяется средними значениями каждого вариационного интервала — $x'_i$. Оптимальная высота столбцов диаграммы вычисляется как отношение абсолютный частоты вариации $n_i$ к ширине интервала $h$: $n_i/h$. Данные значения также дополняют интервальный вариационный ряд. Таблица 5 демонстрирует расширенный интервальный вариационный ряд.

*Таблица 5. Расширенный интервальный вариационный ряд*

| Вариация | *1* | *2* | *3* | *4* | *5* | *6* | $\sum$
-- | -- | -- | -- | -- | -- | -- | --
$x_i; x_i+h$ | $[158; 162]$ | $(162; 166]$ | $(166; 170]$ | $(170; 174]$ | $(174; 178]$ | $(178; 182]$ | $[158; 182]$
$n_i$ | 1 | 6 | 6 | 5 | 7 | 5 | **30**
$w_i = \frac{n_i}{n}$ | 0.033 | 0.200 | 0.200 | 0.167 | 0.233 | 0.167 | **1**
$\frac{n_i}{h}$ | 0.25 | 1.5 | 1.5 | 1.25 | 1.75 | 1.25 | |
$x'_i$ | 160 | 164 | 168 | 172 | 176 | 180 | |

На основе значений расширенного интервального вариационного ряда выполняется построение гистограммы распределения значений признаков. Рисунок 1 иллюстрирует итоговый вид диаграммы.

<figure style="background: white;">

![Histogram](../assets/histogram-0a.png)

<figcaption>Рисунок 1. Гистограмма распределения значений признаков</figcaption>
</figure>

#### 3. Определение основных числовых характеристик
Некоторые числовые характеристики уже были определены ранее, при построении вариационных рядов. Расчет и результирующие значения представлены ниже.

1. $n = 30$ — объем выборки, количество элементов совокупности или сумма абсолютных частот вариант.

2. $x_{\min} = 160$ — наименьшее значение, крайнее левое в таблице.

3. $x_{\max} = 182$ — наибольшее значение, крайнее правое в таблице.

4. $R(x) = x_{\max} - x_{\min} = 182 - 160 = 22$ — размах вариации, разница между крайними значениями.

5. $m_o = 177$ — мода, значение с наибольшей абсолютной частотой.

6. $m_e = (n_{15}+n_{16})/2 = (171+172)/2 = 171.5$ — медиана, значение признака, делящее упорядоченную выборку на две равные по количеству элементов части. Для выборок четного объема определяется как среднее арифметическое двух средних значений отсортированного распределения.

7. $\bar{x} = \frac{1}{n} \sum_{i=1}^n{x_i} \approx 171.73$ — выборочное среднее, среднее арифметическое значений выборки.

8. $S^2 = \frac{1}{n−1} \sum_{i=1}^n{(x_i-\bar{x})^2} \approx 37.03$ — выборочная дисперсия, сумма квадратов отклонений значений выборки от среднего, отнесенная к объему выборки с попровкой на несмещённую оценку.

9. $S = \sqrt{S^2} = \sqrt{37.03} \approx 6.09$ — среднее квадратическое (выборочное стандартное) отклонение, квадратный корень из дисперсии.

10. $c_v = \frac{S}{|\bar{x}|} \cdot 100 = \frac{6.09}{171.73} \cdot 100 \approx 3.54$% — коэффициент вариации (относительное стандартное отклонение), отношение стандартного отклонения к выборочному среднему, выраженное в процентах.

#### 4. Определение обобщенных числовых характеристик

##### Оценка центральной тенденции
Обобщенно по выборке можно сделать выводы о форме распределения и наличии асимметрии:

- $\bar{x} ≈ m_e ≈ m_o$ — распределение, скорее всего, симметрично и близко к нормальному.

- $\bar{x}  > m_e > m_o$ — распределение с положительной скошенностью (правый "хвост").

- $\bar{x} < m_e < m_o$ — распределение с отрицательной скошенностью (левый "хвост").

Исследуемое распределение демонстрирует следующие соотношения:

$$ 171.73 \approx 171.5 < 177 $$

$$ \bar{x} ≈ m_e < m_o $$

**Вывод**: среднее значение выборки составляет 172 (см), медианное — 172 (см), наиболее типичное значение — 177 (см). Среднее и медиана совпадают, мода существенно отличается от них, следовательно, распределение демонстрирует умеренную тенденцию к нормальной форме, но с существенными признаками отрицательной скошенности, поскольку медиана меньше моды и среднего, что в целом подтверждается формой гистограммы распределения.

##### Оценка разрабоса данных
Для оценки нормальности распределения используют правило трех сигм. Определяются границы доверительных интервалов, а затем вычисляется относительное количество значений выборки, попадающих в границы данных интервалов:

1. $\pm 1\sigma: \bar{x} \pm 1 \cdot \sigma: [165.65; 177.82] : 18/30 = 60\%$
2. $\pm 2\sigma: \bar{x} \pm 2 \cdot \sigma: [159.56; 183.90] : 30/30 = 100\%$
3. $\pm 3\sigma: \bar{x} \pm 3 \cdot \sigma: [153.48; 189.99] : 30/30 = 100\%$

Полученные значения сравнивают с эмпирическими критериями нормально распределённых данных: примерно 68% значений должны находиться в интервале ±1 стандартное отклонение от среднего, 95% — в пределах ±2, 99.7% — в пределах ±3.

Для оценки симметричности выборки используют оценку близости медианы и среднего: если выполняется соотношение $\vert \bar{x} - m_e \vert \le \frac{3 S}{\sqrt{n}}$, то выборка считается симметричной.

$$ \vert \bar{x} - m_e \vert = \vert 171.73 - 171.5 \vert = 0.2(3) $$

$$ \frac{3 S}{\sqrt{n}} = \frac{3 \cdot 6.09}{\sqrt{30}} \approx 3.33 $$

$$ \vert \bar{x} - m_e \vert < \frac{3 S}{\sqrt{n}} $$

**Вывод**: размах значений составлят 22 (см) — от 160 до 182, стандартное  отклонение — 6 (см); распределение в целом близко к нормальному, поскольку выполняется правило трех сигм, при этом наблюдается умеренная тенденция к асимметрии, т.к. только около 60% значений находятся в интервале ±1 стандартное отклонение от среднего (вместо ожидаемых 68%), при этом 100% значений находятся в пределах ±2 и ±3 стандартных отклонений. Выборка симметрична, поскольку выполняется неравенство отклонения медианы от среднего.

##### Оценка степени вариативности
Критерии оценки степени вариативности по коэффициенту вариации:

- $c_v < 10$% — низкая вариативность (признак однородный);

- $10$% $≤ c_v ≤ 20$% — средняя вариативность;

- $c_v > 20$% — высокая вариативность;

- $c_v > 40$% — очень высокая вариативность, признак сильно изменчив.

**Вывод**: выборка является однородной, поскольку коэффициент вариации 3,54% меньше 10%, что свидетельствует о высокой стабильности признака

### Заключение
В ходе проделанной работы были построены дискретный и интервальный вариационные ряды для выборки данных по признаку "рост", а также гистограмма распределения значений. Рассчитаны ключевые числовые характеристики распределения, позволяющие провести всестороннюю оценку — центральную тенденцию, разброс и степень вариативности исследуемого признака. На основе рассчитанных значений сделаны выводы о форме распределения, однородности, симметричности выборки и других особенностях признаков, что позволяет провести корректный статистический анализ, на основе которого можно  принимать дальнейшие решения относительно использования исследуемых данных.

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0-rc.1/dist/katex.min.css" integrity="sha384-D+9gmBxUQogRLqvARvNLmA9hS2x//eK1FhVb9PiU86gmcrBrJAQT8okdJ4LMp2uv" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.0-rc.1/dist/katex.min.js" integrity="sha384-483A6DwYfKeDa0Q52fJmxFXkcPCFfnXMoXblOkJ4JcA8zATN6Tm78UNL72AKk+0O" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.0-rc.1/dist/contrib/auto-render.min.js" integrity="sha384-yACMu8JWxKzSp/C1YV86pzGiQ/l1YUfE8oPuahJQxzehAjEt2GiQuy/BIvl9KyeF" crossorigin="anonymous"></script>
<script>
  window.onload = () => {
    renderMathInElement(document.body, {
      delimiters: [
        {left: "$$", right: "$$", display: true},
        {left: "$", right: "$", display: false}
      ],
      macros: {
        "\\\n": "\\\\",
      }
    });
  };
</script>
